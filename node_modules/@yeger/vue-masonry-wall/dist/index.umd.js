(function(e,r){typeof exports=="object"&&typeof module<"u"?module.exports=r(require("vue")):typeof define=="function"&&define.amd?define(["vue"],r):(e=typeof globalThis<"u"?globalThis:e||self,e.MasonryWall=r(e.Vue))})(this,function(e){"use strict";const r=["data-index"],C=e.defineComponent({__name:"masonry-wall",props:{columnWidth:{default:400},items:null,gap:{default:0},rtl:{type:Boolean,default:!1},ssrColumns:{default:0},scrollContainer:{default:null}},emits:["redraw","redrawSkip"],setup(s,{emit:p}){const _=s,{columnWidth:h,items:c,gap:i,rtl:g,ssrColumns:y,scrollContainer:w}=e.toRefs(_),u=e.ref([]),d=e.ref();function k(){const n=Math.floor((d.value.getBoundingClientRect().width+i.value)/(h.value+i.value));return n>0?n:1}function B(n){return[...new Array(n)].map(()=>[])}if(y.value>0){const n=B(y.value);c.value.forEach((t,l)=>n[l%y.value].push(l)),u.value=n}async function x(n){if(n>=c.value.length)return;await e.nextTick();const t=[...d.value.children];g.value&&t.reverse();const l=t.reduce((f,o)=>o.getBoundingClientRect().height<f.getBoundingClientRect().height?o:f);u.value[+l.dataset.index].push(n),await x(n+1)}async function m(n=!1){if(u.value.length===k()&&!n){p("redrawSkip");return}u.value=B(k());const t=w==null?void 0:w.value,l=t?t.scrollTop:window.scrollY;await x(0),t?t.scrollBy({top:l-t.scrollTop}):window.scrollTo({top:l}),p("redraw")}const a=typeof ResizeObserver>"u"?void 0:new ResizeObserver(()=>m());return e.onMounted(()=>{m(),a==null||a.observe(d.value)}),e.onBeforeUnmount(()=>a==null?void 0:a.unobserve(d.value)),e.watch([c,g],()=>m(!0)),e.watch([h,i],()=>m()),(n,t)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"wall",ref:d,class:"masonry-wall",style:e.normalizeStyle({display:"flex",gap:`${e.unref(i)}px`})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.value,(l,f)=>(e.openBlock(),e.createElementBlock("div",{key:f,class:"masonry-column","data-index":f,style:e.normalizeStyle({display:"flex","flex-basis":"0px","flex-direction":"column","flex-grow":1,gap:`${e.unref(i)}px`,height:["-webkit-max-content","-moz-max-content","max-content"],"min-width":0})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l,o=>(e.openBlock(),e.createElementBlock("div",{key:o,class:"masonry-item"},[e.renderSlot(n.$slots,"default",{item:e.unref(c)[o],index:o},()=>[e.createTextVNode(e.toDisplayString(e.unref(c)[o]),1)])]))),128))],12,r))),128))],4))}});return(()=>{const s=C;return s.install=p=>{p.component("MasonryWall",s)},s})()});
